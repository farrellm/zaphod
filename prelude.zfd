(data Bool
      False
      True)

(data (Maybe a)
      Nothing
      (Just a))

(data (Either a b)
      (Left a)
      (Right b))

(data (List a)
      Nil
      (Cons a (List a)))

(data Nat
      Z
      (S Nat))

(defn (id x)
  (forall (a) (-> [a] a))
  x)

(defn (append xs ys)
  (forall (a b) (-> [a b] Top))
  (if (is-nil xs)
      (: ys Top)
      (cons (car xs) (append (cdr xs) ys))))

(defn (reverse' xs ys)
  (forall (a b) (-> [a b] Top))
  (if (is-nil xs)
      (: ys Top)
      (reverse' (cdr xs) (cons (car xs) ys))))

(defn (reverse xs)
  (forall a (-> [a] Top))
  (reverse' xs ()))

(defn (not p)
  (-> [Bool] Bool)
  (if p False True))

(defn (maybe d f m)
  (forall (a b) (-> [b (-> [a] b) (Maybe a)] b))
  (if (is-symbol m)
      d
      (f (unsafe-coerce (cadr m)))))

(defn (curry f x)
  (forall (a b c) (-> [(-> (cons b a) c) b]
                      (-> a c)))
  (lambda y (apply f (cons x y))))
